---
import Layout from '../layouts/Layout.astro';
import { client } from '../data/client';
const ap = client.apropos;
---

<Layout
  title={`L'histoire — ${client.nom}`}
  description={`Découvrez l'histoire de ${client.nom}, barbershop à ${client.ville}. ${ap.paragraphe1}`}
>

  <!-- ══════ NAVBAR ══════ -->
  <nav class="navbar" id="navbar">
    <div class="nav-inner">
      <a href="/" class="nav-logo">
        <img src={client.logo} alt={client.nom} class="nav-logo-img" onerror="this.style.display='none'" />
        <span class="nav-name font-display">{client.nom}</span>
      </a>
      <div class="nav-links">
        <a href="/#tarifs">Tarifs</a>
        <a href="/galerie">Galerie</a>
        <a href="/a-propos" class="nav-active">L'histoire</a>
        <a href="/#equipe">L'équipe</a>
        <a href="/#rdv" class="nav-cta">Prendre RDV</a>
      </div>
      <button class="burger" id="burger" aria-label="Menu"><span></span><span></span><span></span></button>
    </div>
    <div class="nav-mobile" id="mobile-menu">
      <a href="/#tarifs">Tarifs</a>
      <a href="/galerie">Galerie</a>
      <a href="/a-propos">L'histoire</a>
      <a href="/#equipe">L'équipe</a>
      <a href="/#avis">Avis</a>
      <a href="/#rdv" class="mob-cta">Prendre rendez-vous</a>
    </div>
  </nav>

  <!-- ══════ PAGE HEADER ══════ -->
  <section class="page-header">
    <div class="ph-bg"><img src={client.bannerImage} alt="" loading="eager" /></div>
    <div class="ph-overlay"></div>
    <div class="ph-gold-stripe"></div>
    <div class="container ph-content">
      <a href="/" class="back-link reveal">← Retour à l'accueil</a>
      <span class="sec-label font-display reveal reveal-d1">{ap.sousTitre}</span>
      <h1 class="font-display reveal reveal-d2">
        {ap.titre.split(',')[0].toUpperCase()},<br /><span class="text-gold">{ap.titre.split(',').slice(1).join(',').trim().toUpperCase() || 'UN RITUEL'}</span>
      </h1>
    </div>
  </section>

  <!-- ══════ STORY — Intro ══════ -->
  <section class="section">
    <div class="container story-intro">
      <div class="story-text slide-left">
        <span class="quote-mark font-display">"</span>
        <p class="story-p1">{ap.paragraphe1}</p>
        <p class="story-p2">{ap.paragraphe2}</p>
        <a href="/#rdv" class="btn-gold" style="margin-top:28px;display:inline-flex;">Réserver une séance →</a>
      </div>
      <div class="story-img-stack slide-right">
        <div class="si-main img-zoom">
          <img src={ap.image} alt={ap.imageAlt} loading="lazy" />
        </div>
        <div class="si-secondary img-zoom">
          <img src={ap.image2} alt={ap.image2Alt} loading="lazy" />
        </div>
        <div class="si-badge font-display">
          <span class="si-badge-num">{ ap.sousTitre.match(/\d{4}/) ? String(new Date().getFullYear() - parseInt(ap.sousTitre.match(/\d{4}/)?.[0] ?? '2018')) : '6+' }</span>
          <span class="si-badge-label">ans<br/>d'expertise</span>
        </div>
      </div>
    </div>
  </section>

  <!-- ══════ VALEURS ══════ -->
  <section class="section section-alt">
    <div class="container">
      <div class="sec-head">
        <span class="sec-label font-display reveal">Ce qui nous définit</span>
        <h2 class="sec-title font-display reveal reveal-d1">NOS <span class="text-gold">VALEURS</span></h2>
      </div>
      <div class="values-grid">
        {ap.valeurs.map((v, i) => (
          <div class={`value-card hover-lift reveal ${i > 0 ? `reveal-d${i}` : ''}`}>
            <span class="value-icon">{v.icone}</span>
            <h3 class="font-display">{v.titre.toUpperCase()}</h3>
            <p>{v.description}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- ══════ TIMELINE ══════ -->
  <section class="section">
    <div class="container">
      <div class="sec-head">
        <span class="sec-label font-display reveal">Notre parcours</span>
        <h2 class="sec-title font-display reveal reveal-d1">L'<span class="text-gold">HISTOIRE</span></h2>
      </div>
      <div class="timeline">
        <div class="tl-item reveal">
          <div class="tl-dot"></div>
          <div class="tl-year font-display">{ ap.sousTitre.match(/\d{4}/)?.[0] ?? '2018' }</div>
          <div class="tl-body">
            <h4>{client.nom} ouvre ses portes</h4>
            <p>Ouverture du premier salon à {client.ville}. Une vision claire : redonner ses lettres de noblesse au métier de barbier.</p>
          </div>
        </div>
        <div class="tl-item tl-right reveal reveal-d1">
          <div class="tl-dot"></div>
          <div class="tl-year font-display">+1 an</div>
          <div class="tl-body">
            <h4>Première reconnaissance locale</h4>
            <p>Élu meilleur barbershop de {client.ville} par nos clients. La réputation grandit, le bouche-à-oreille fait le reste.</p>
          </div>
        </div>
        <div class="tl-item reveal reveal-d2">
          <div class="tl-dot"></div>
          <div class="tl-year font-display">Aujourd'hui</div>
          <div class="tl-body">
            <h4>Une équipe de {client.equipe.length} barbiers passionnés</h4>
            <p>Des centaines de clients fidèles, un cadre authentique, et la même exigence depuis le premier jour.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ══════ ÉQUIPE PREVIEW ══════ -->
  <section class="section section-alt">
    <div class="container">
      <div class="sec-head">
        <span class="sec-label font-display reveal">Derrière les ciseaux</span>
        <h2 class="sec-title font-display reveal reveal-d1">L'<span class="text-gold">ÉQUIPE</span></h2>
      </div>
      <div class="team-grid">
        {client.equipe.map((b, i) => (
          <div class={`team-card hover-lift reveal ${i > 0 ? `reveal-d${i}` : ''}`}>
            <div class="team-img img-zoom">
              <img src={b.image} alt={b.prenom} loading="lazy" />
            </div>
            <div class="team-info">
              <h3 class="font-display">{b.prenom}</h3>
              <span class="team-role">{b.role}</span>
              <div class="team-details">
                <span>⏱ {b.experience}</span>
                <span>✂️ {b.specialite}</span>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- ══════ CTA ══════ -->
  <section class="section cta-band">
    <div class="container">
      <div class="cta-inner reveal">
        <div>
          <span class="sec-label font-display">Faites partie de l'histoire</span>
          <h2 class="font-display cta-title">RÉSERVEZ VOTRE <span class="text-gold">SÉANCE</span></h2>
        </div>
        <div class="cta-actions">
          <a href="/#rdv" class="btn-gold btn-lg">Prendre rendez-vous</a>
          <a href="/galerie" class="btn-ghost">Voir la galerie →</a>
        </div>
      </div>
    </div>
  </section>

  <!-- ══════ FOOTER ══════ -->
  <footer class="footer">
    <div class="container">
      <div class="footer-grid">
        <div>
          <span class="footer-logo font-display shimmer">{client.nom}</span>
          <p class="footer-desc">{client.specialite}. {client.ville}.</p>
        </div>
        <div>
          <h4 class="font-display">NAVIGATION</h4>
          <a href="/">Accueil</a>
          <a href="/#tarifs">Tarifs</a>
          <a href="/galerie">Galerie</a>
          <a href="/a-propos">L'histoire</a>
          <a href="/#rdv">Rendez-vous</a>
        </div>
        <div>
          <h4 class="font-display">INFOS</h4>
          <a href={client.telephoneLink}>{client.telephone}</a>
          <a href={`mailto:${client.email}`}>{client.email}</a>
          <span class="footer-addr">{client.adresse}</span>
          <a href="/mentions-legales">Mentions légales</a>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2026 {client.nom}</p>
        <a href="https://vitemonsite-artisan.fr" target="_blank" rel="noopener" class="footer-badge">Site par <strong>LORN Digital Studio</strong></a>
      </div>
    </div>
  </footer>

</Layout>

<script>
  /* ─── Navbar scroll ─── */
  const navbar = document.getElementById('navbar');
  window.addEventListener('scroll', () => navbar?.classList.toggle('scrolled', window.scrollY > 50), { passive: true });

  /* ─── Burger menu ─── */
  const burger = document.getElementById('burger');
  const mobileMenu = document.getElementById('mobile-menu');
  burger?.addEventListener('click', () => {
    burger.classList.toggle('open');
    mobileMenu?.classList.toggle('open');
  });

  /* ─── Reveal on scroll ─── */
  const observer = new IntersectionObserver(
    (entries) => entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); }),
    { threshold: 0.1 }
  );
  document.querySelectorAll('.reveal, .slide-left, .slide-right').forEach(el => observer.observe(el));
</script>

<style>
  /* ═══ NAVBAR ═══ */
  .navbar{position:fixed;top:0;left:0;right:0;z-index:100;padding:10px clamp(0.75rem,3vw,2rem);transition:padding 0.4s;}
  .navbar.scrolled{padding-top:5px;padding-bottom:5px;}
  .nav-inner{max-width:1100px;margin:0 auto;padding:10px 18px;border-radius:14px;background:rgba(10,10,10,0.88);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid var(--border);box-shadow:0 4px 24px rgba(0,0,0,0.3);display:flex;align-items:center;justify-content:space-between;gap:8px;transition:all 0.4s;}
  .navbar.scrolled .nav-inner{padding:7px 14px;}
  .nav-logo{display:flex;align-items:center;gap:8px;}
  .nav-logo-img{width:36px;height:36px;border-radius:8px;object-fit:contain;}
  .nav-name{font-size:18px;color:var(--gold-light);}
  .nav-links{display:flex;gap:2px;align-items:center;}
  .nav-links a{font-size:13px;font-weight:500;color:var(--text-muted);padding:7px 12px;border-radius:8px;transition:all 0.3s;white-space:nowrap;}
  .nav-links a:hover,.nav-active{color:var(--gold-light)!important;}
  .nav-cta{padding:8px 18px!important;border-radius:10px!important;background:var(--gold)!important;color:#000!important;font-weight:700!important;font-size:12px!important;transition:all 0.3s!important;}
  .nav-cta:hover{background:var(--gold-light)!important;transform:translateY(-1px);}
  .burger{display:none;background:none;border:none;cursor:pointer;padding:8px;flex-direction:column;gap:5px;}
  .burger span{width:20px;height:2px;background:var(--gold-light);border-radius:2px;display:block;transition:all 0.3s;}
  .burger.open span:nth-child(1){transform:rotate(45deg) translateY(7px);} .burger.open span:nth-child(2){opacity:0;} .burger.open span:nth-child(3){transform:rotate(-45deg) translateY(-7px);}
  .nav-mobile{display:none;max-width:1100px;margin:6px auto 0;padding:12px;border-radius:14px;background:rgba(10,10,10,0.95);backdrop-filter:blur(20px);border:1px solid var(--border);flex-direction:column;gap:2px;}
  .nav-mobile.open{display:flex;}
  .nav-mobile a{padding:12px 14px;border-radius:10px;font-size:15px;color:var(--text);font-weight:500;}
  .mob-cta{margin-top:6px;padding:13px!important;border-radius:10px;background:var(--gold);color:#000!important;text-align:center;font-weight:700!important;}
  @media(max-width:768px){.nav-links{display:none!important;}.burger{display:flex!important;}}

  /* ═══ PAGE HEADER ═══ */
  .page-header{position:relative;padding:clamp(8rem,14vw,10rem) 0 clamp(3rem,6vw,4rem);overflow:hidden;}
  .ph-bg{position:absolute;inset:0;} .ph-bg img{width:100%;height:100%;object-fit:cover;}
  .ph-overlay{position:absolute;inset:0;background:linear-gradient(180deg,rgba(10,10,10,0.82) 0%,rgba(10,10,10,0.7) 50%,rgba(10,10,10,0.95) 100%);}
  .ph-gold-stripe{position:absolute;top:0;left:0;bottom:0;width:4px;background:linear-gradient(180deg,transparent,var(--gold-light),var(--gold),transparent);}
  .ph-content{position:relative;z-index:2;}
  .back-link{display:inline-block;font-size:13px;color:var(--gold-light);margin-bottom:20px;font-weight:500;transition:opacity 0.3s;}
  .back-link:hover{opacity:0.75;}
  .ph-content h1{font-size:clamp(2.5rem,8vw,5rem);color:var(--white);line-height:1;margin:6px 0 0;}

  /* ═══ STORY INTRO ═══ */
  .story-intro{display:grid;grid-template-columns:1fr 1fr;gap:clamp(2rem,5vw,4rem);align-items:center;}
  .story-text .quote-mark{font-size:80px;line-height:0.6;color:var(--gold);display:block;margin-bottom:10px;}
  .story-p1{font-size:17px;line-height:1.85;color:var(--text);margin-bottom:16px;font-weight:500;}
  .story-p2{font-size:15px;line-height:1.8;color:var(--text-muted);}
  .story-img-stack{position:relative;height:540px;}
  .si-main{position:absolute;top:0;left:0;right:80px;height:420px;border-radius:18px;overflow:hidden;border:1px solid var(--border);}
  .si-main img,.si-secondary img{width:100%;height:100%;object-fit:cover;}
  .si-secondary{position:absolute;bottom:0;right:0;width:55%;height:240px;border-radius:14px;overflow:hidden;border:2px solid var(--gold);}
  .si-badge{position:absolute;top:24px;right:60px;background:var(--gold);color:#000;padding:12px 16px;border-radius:12px;text-align:center;box-shadow:0 4px 24px rgba(184,134,11,0.3);}
  .si-badge-num{display:block;font-size:32px;line-height:1;}
  .si-badge-label{font-size:11px;font-family:'Barlow',sans-serif;font-weight:700;letter-spacing:0.02em;line-height:1.3;}

  /* ═══ VALEURS ═══ */
  .values-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;}
  .value-card{padding:28px 22px;border-radius:18px;background:var(--bg-card);border:1px solid var(--border);text-align:center;}
  .value-icon{display:block;font-size:32px;margin-bottom:12px;}
  .value-card h3{font-size:20px;color:var(--gold-light);margin-bottom:8px;letter-spacing:0.06em;}
  .value-card p{font-size:13px;color:var(--text-muted);line-height:1.7;}

  /* ═══ TIMELINE ═══ */
  .timeline{max-width:700px;margin:0 auto;display:flex;flex-direction:column;gap:0;position:relative;}
  .timeline::before{content:'';position:absolute;left:20px;top:6px;bottom:6px;width:2px;background:linear-gradient(to bottom,var(--gold),transparent);}
  .tl-item{display:flex;align-items:flex-start;gap:20px;padding:20px 0;position:relative;}
  .tl-dot{width:14px;height:14px;border-radius:50%;background:var(--gold);border:2px solid var(--gold-pale);flex-shrink:0;margin-top:6px;z-index:1;box-shadow:0 0 0 4px var(--gold-glow);}
  .tl-year{font-size:22px;color:var(--gold-light);width:80px;flex-shrink:0;padding-top:2px;}
  .tl-body{flex:1;}
  .tl-body h4{font-size:16px;font-weight:700;color:var(--white);margin-bottom:6px;}
  .tl-body p{font-size:14px;color:var(--text-muted);line-height:1.7;}
  .tl-right{flex-direction:row;}

  /* ═══ TEAM ═══ */
  .team-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;}
  .team-card{border-radius:18px;overflow:hidden;background:var(--bg-card);border:1px solid var(--border);}
  .team-img img{width:100%;aspect-ratio:3/4;object-fit:cover;}
  .team-info{padding:20px;}
  .team-info h3{font-size:26px;color:var(--gold-light);margin-bottom:2px;}
  .team-role{font-size:13px;color:var(--text-muted);display:block;margin-bottom:10px;}
  .team-details{display:flex;gap:14px;font-size:12px;color:var(--text-light);}

  /* ═══ CTA BAND ═══ */
  .cta-band{}
  .cta-inner{display:flex;justify-content:space-between;align-items:center;gap:24px;flex-wrap:wrap;padding:32px;border-radius:24px;background:var(--bg-card);border:1px solid var(--border-gold);}
  .cta-title{font-size:clamp(1.6rem,4vw,2.8rem);color:var(--white);line-height:1;}
  .cta-actions{display:flex;gap:12px;flex-wrap:wrap;}

  /* ═══ BUTTONS ═══ */
  .btn-gold{display:inline-flex;align-items:center;gap:8px;padding:15px 32px;border-radius:12px;background:var(--gold);color:#000;font-family:'Barlow',sans-serif;font-weight:700;font-size:15px;border:none;cursor:pointer;transition:all 0.3s;box-shadow:0 2px 16px var(--gold-glow);}
  .btn-gold:hover{background:var(--gold-light);transform:translateY(-2px);box-shadow:0 6px 32px rgba(184,134,11,0.25);}
  .btn-lg{padding:18px 40px;font-size:16px;}
  .btn-ghost{display:inline-flex;align-items:center;gap:8px;padding:15px 28px;border-radius:12px;color:var(--text);font-weight:500;font-size:15px;border:1px solid var(--border);transition:all 0.3s;}
  .btn-ghost:hover{border-color:var(--gold);color:var(--gold-light);}

  /* ═══ SECTION / SHARED ═══ */
  .sec-head{text-align:center;margin-bottom:48px;}
  .sec-label{display:block;font-size:13px;color:var(--gold);letter-spacing:0.15em;margin-bottom:6px;}
  .sec-title{font-size:clamp(2rem,5vw,3rem);color:var(--white);line-height:1;}
  .text-gold{color:var(--gold-light);}

  /* ═══ FOOTER ═══ */
  .footer{padding:clamp(3rem,6vw,4rem) 0 2rem;border-top:1px solid var(--border);}
  .footer-grid{display:grid;grid-template-columns:1.5fr 1fr 1fr;gap:32px;margin-bottom:28px;}
  .footer-logo{display:block;font-size:24px;margin-bottom:8px;color:var(--gold-light);}
  .footer-desc{font-size:14px;line-height:1.6;color:var(--text-muted);max-width:260px;}
  .footer-grid h4{font-size:16px;color:var(--gold-light);margin-bottom:12px;letter-spacing:0.1em;}
  .footer-grid a{display:block;font-size:13px;color:var(--text-muted);margin-bottom:8px;transition:color 0.2s;} .footer-grid a:hover{color:var(--gold-light);}
  .footer-addr{display:block;font-size:12px;color:var(--text-light);margin-top:6px;}
  .footer-bottom{display:flex;justify-content:space-between;align-items:center;border-top:1px solid var(--border);padding-top:16px;font-size:12px;color:var(--text-light);}
  .footer-badge{padding:4px 10px;border-radius:6px;border:1px solid var(--border);font-size:11px;color:var(--text-muted);transition:all 0.3s;}
  .footer-badge strong{color:var(--text);} .footer-badge:hover{border-color:var(--gold);} .footer-badge:hover strong{color:var(--gold-light);}

  /* ═══ RESPONSIVE ═══ */
  @media(max-width:1024px){
    .values-grid{grid-template-columns:repeat(2,1fr);}
    .team-grid{grid-template-columns:repeat(2,1fr);}
  }
  @media(max-width:768px){
    .story-intro{grid-template-columns:1fr;}
    .story-img-stack{height:320px;}
    .si-main{right:40px;height:260px;}
    .si-secondary{width:50%;height:160px;}
    .si-badge{right:30px;}
    .team-grid,.footer-grid{grid-template-columns:1fr;}
    .footer-bottom{flex-direction:column;gap:8px;}
    .cta-inner{flex-direction:column;text-align:center;}
    .values-grid{grid-template-columns:1fr 1fr;}
    .timeline::before{left:17px;}
  }
</style>
